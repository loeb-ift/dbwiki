# DB-GPT-WEBUI: æ‚¨çš„æ™ºèƒ½è³‡æ–™åº«å•ç­”å¤¥ä¼´

![Python](https://img.shields.io/badge/Python-3.8%2B-blue)
![Flask](https://img.shields.io/badge/Flask-2.x-green)
![Vanna.ai](https://img.shields.io/badge/Vanna.ai-0.3.x-purple)
![License](https://img.shields.io/badge/License-MIT-lightgrey)

é€™æ˜¯ä¸€å€‹åŸºæ–¼ Vanna.ai å’Œ Flask çš„æ™ºèƒ½è³‡æ–™åº«å•ç­”ç³»çµ±ï¼Œæä¾›ç›´è§€çš„åœ–å½¢ä»‹é¢ï¼Œè®“ä½¿ç”¨è€…å¯ä»¥é€éè‡ªç„¶èªè¨€èˆ‡è³‡æ–™åº«é€²è¡Œäº’å‹•ã€‚ç³»çµ±æ”¯æ´å¤šä½¿ç”¨è€…ç®¡ç†ã€è³‡æ–™é›†ä¸Šå‚³ã€AI æ¨¡å‹è¨“ç·´ä»¥åŠæ™ºèƒ½ SQL ç”Ÿæˆï¼Œç‚ºè³‡æ–™åˆ†ææä¾›å¼·å¤§æ”¯æ´ã€‚

![DB-GPT-WEBUI Demo](./img/vanna-readme-diagram.png)
*(æ‚¨å¯ä»¥åœ¨æ­¤æ›¿æ›ç‚ºå°ˆæ¡ˆçš„ GIF å‹•æ…‹åœ–æˆ–ä»‹é¢æˆªåœ–)*

---

## âœ¨ åŠŸèƒ½äº®é» (Features)

- **ğŸ¤– è‡ªç„¶èªè¨€è½‰ SQL**ï¼šé€éå¤§å‹èªè¨€æ¨¡å‹ (LLM) å°‡ä½¿ç”¨è€…çš„è‡ªç„¶èªè¨€å•é¡Œè½‰æ›ç‚ºå¯åŸ·è¡Œçš„ SQL æŸ¥è©¢ã€‚
- **ğŸ‘¥ å¤šä½¿ç”¨è€…éš”é›¢**ï¼šæ¯å€‹ä½¿ç”¨è€…æ“æœ‰ç¨ç«‹çš„è¨“ç·´è³‡æ–™å’Œè³‡æ–™é›†ï¼Œç¢ºä¿è³‡æ–™éš”é›¢å’Œå®‰å…¨ã€‚
- **ğŸ“‚ éˆæ´»çš„è³‡æ–™é›†ç®¡ç†**ï¼šæ”¯æ´ä¸Šå‚³ CSV æª”æ¡ˆå»ºç«‹è³‡æ–™é›†ï¼Œä¸¦å°å¤šå€‹è³‡æ–™é›†é€²è¡Œå¢åˆªæ”¹æŸ¥ã€‚
- **ğŸ§  AI é©…å‹•çš„æ¨¡å‹è¨“ç·´**ï¼šé€éæä¾› DDLã€æ¥­å‹™æ–‡ä»¶å’Œ SQL å•ç­”é…å°ä¾†è¨“ç·´è‡ªå®šç¾©æ¨¡å‹ï¼Œè®“ AI æ›´æ‡‚æ‚¨çš„è³‡æ–™ã€‚
- **ğŸ”¬ è³‡æ–™åº«è‡ªå‹•åˆ†æ**ï¼šä¸€éµå°æ•´å€‹è³‡æ–™åº«é€²è¡Œå…ƒåˆ†æï¼Œç”Ÿæˆé—œæ–¼ã€Œå¦‚ä½•æŸ¥è©¢é€™å€‹è³‡æ–™åº«ã€çš„ AI æ€è€ƒéç¨‹ç¸½çµã€‚
- **ğŸ“Š æ™ºèƒ½è³‡æ–™è¦–è¦ºåŒ–**ï¼šè‡ªå‹•å°‡æŸ¥è©¢çµæœç”Ÿæˆç‚º Plotly äº’å‹•å¼åœ–è¡¨ï¼Œç›´è§€å±•ç¤ºè³‡æ–™æ´å¯Ÿã€‚
- **ğŸ”Œ å¤š LLM ç›¸å®¹**ï¼šæ”¯æ´å¤šç¨® LLM ä¾›æ‡‰å•†ï¼ŒåŒ…æ‹¬æœ¬åœ°é‹è¡Œçš„ **Ollama** å’Œé›²ç«¯çš„ **OpenAI** ç­‰ã€‚
- **ğŸ” å®‰å…¨çš„ä½¿ç”¨è€…èªè­‰**ï¼šå…§å»ºåŸºæ–¼å¯†ç¢¼é›œæ¹Šçš„ä½¿ç”¨è€…èªè­‰ç³»çµ±ï¼Œä¿éšœç³»çµ±å®‰å…¨ã€‚

## ğŸš€ å¿«é€Ÿé–‹å§‹ (Quick Start)

### 1. ç’°å¢ƒæº–å‚™
- ç¢ºä¿æ‚¨å·²å®‰è£ Python 3.8 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
- è¤‡è£½æœ¬å€‰åº«åˆ°æ‚¨çš„æœ¬åœ°æ©Ÿå™¨ã€‚

### 2. å®‰è£ä¾è³´
åœ¨å°ˆæ¡ˆæ ¹ç›®éŒ„ä¸‹ï¼ŒåŸ·è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£æ‰€æœ‰å¿…éœ€çš„ Python å¥—ä»¶ï¼š
```bash
pip install -r requirements.txt
```

### 3. é…ç½®ç’°å¢ƒ
è¤‡è£½ `.env.example` æª”æ¡ˆç‚º `.env`ï¼Œç„¶å¾Œæ ¹æ“šæ‚¨çš„éœ€æ±‚ç·¨è¼¯é…ç½®ã€‚
```bash
cp .env.example .env
```
æ‚¨éœ€è¦**è‡³å°‘é¸æ“‡ä¸€ç¨®** LLM ä¾›æ‡‰å•†ä¸¦å¡«å…¥å°æ‡‰çš„è¨­å®šï¼š

- **æœ¬åœ° Ollama (æ¨è–¦)**
  ```
  OLLAMA_HOST=http://localhost:11434
  OLLAMA_MODEL=your-model-name:latest
  ```

- **OpenAI**
  ```
  OPENAI_API_KEY="sk-..."
  OPENAI_MODEL="gpt-4-turbo"
  ```

æ‚¨ä¹Ÿå¯ä»¥åœ¨ `.env` æª”æ¡ˆä¸­è‡ªå®šç¾©ä½¿ç”¨è€…å’ŒåŸ è™Ÿç­‰è¨­å®šï¼š
```
# Flask æœƒè©±é‡‘é‘°ï¼Œç•™ç©ºå‰‡è‡ªå‹•ç”Ÿæˆ
SECRET_KEY=

# æœƒè©±è¶…æ™‚æ™‚é–“ (åˆ†é˜)
SESSION_TIMEOUT_MINUTES=30

# JSON æ ¼å¼çš„ä½¿ç”¨è€…é…ç½®
# ç°¡å–®æ ¼å¼: {"username": "password"}
# å®Œæ•´æ ¼å¼: {"username": {"password": "...", "is_admin": true/false}}
APP_USERS={"testuser": "password"}

# æ‡‰ç”¨ç¨‹å¼åŸ è™Ÿ
PORT=5004
```

### 4. å•Ÿå‹•æ‡‰ç”¨
```bash
python run.py
```
æ‡‰ç”¨å•Ÿå‹•å¾Œï¼Œæ‚¨å¯ä»¥åœ¨ç€è¦½å™¨ä¸­å­˜å– `http://localhost:5004`ã€‚

---

## ğŸ“– ä½¿ç”¨æŒ‡å— (Usage Guide)

1.  **ä½¿ç”¨è€…ç™»å…¥**
    ä½¿ç”¨æ‚¨åœ¨ `.env` æª”æ¡ˆä¸­é…ç½®çš„ä½¿ç”¨è€…åç¨±å’Œå¯†ç¢¼ç™»å…¥ã€‚

2.  **è³‡æ–™é›†ç®¡ç†**
    - **å»ºç«‹**ï¼šé»æ“Šã€Œ+ æ–°å¢ã€æŒ‰éˆ•ï¼Œè¼¸å…¥è³‡æ–™é›†åç¨±ä¸¦ä¸Šå‚³æ‚¨çš„ CSV æª”æ¡ˆã€‚
    - **é¸æ“‡**ï¼šå¾é ‚éƒ¨ä¸‹æ‹‰é¸å–®ä¸­é¸æ“‡è¦æ“ä½œçš„è³‡æ–™é›†ã€‚
    - **ç®¡ç†**ï¼šæ”¯æ´é‡æ–°å‘½åå’Œåˆªé™¤å·²å­˜åœ¨çš„è³‡æ–™é›†ã€‚

3.  **æ¨¡å‹è¨“ç·´**
    - åœ¨è¨“ç·´é é¢ï¼Œç³»çµ±æœƒè‡ªå‹•è¼‰å…¥è³‡æ–™é›†çš„ DDLï¼ˆè³‡æ–™è¡¨çµæ§‹ï¼‰ã€‚
    - æ‚¨å¯ä»¥æ·»åŠ **æ¥­å‹™æ–‡ä»¶**ï¼ˆå¦‚æ¬„ä½å®šç¾©ã€æ¥­å‹™è¦å‰‡ï¼‰å’Œ **SQL å•ç­”é…å°**ä¾†è±å¯Œè¨“ç·´ææ–™ã€‚
    - é»æ“Šã€Œé‡æ–°è¨“ç·´æ•´å€‹æ¨¡å‹ã€é–‹å§‹è¨“ç·´ã€‚ç³»çµ±æœƒå°‡é€™äº›ææ–™å‘é‡åŒ–ï¼Œä¾› AI åœ¨å¾ŒçºŒæå•æ™‚åƒè€ƒã€‚

4.  **æå•èˆ‡åˆ†æ**
    - æ¨¡å‹è¨“ç·´å®Œæˆå¾Œï¼Œåœ¨â€œæ™ºèƒ½æå•â€é é¢è¼¸å…¥æ‚¨çš„å•é¡Œã€‚
    - ç³»çµ±å°‡è‡ªå‹•å®Œæˆ**æª¢ç´¢ä¸Šä¸‹æ–‡ -> ç”Ÿæˆ SQL -> åŸ·è¡ŒæŸ¥è©¢ -> æ¸²æŸ“åœ–è¡¨ -> ç”Ÿæˆæ–‡å­—è§£é‡‹**çš„å…¨éç¨‹ã€‚

---

## ğŸ”¬ ç‰¹è‰²åŠŸèƒ½ï¼šAI é©…å‹•çš„æµæ°´è™Ÿåˆ†æ

æœ¬ç³»çµ±æä¾›ä¸€å€‹ç”± AI é©…å‹•çš„è‡ªå‹•åŒ–åˆ†ææµç¨‹ï¼Œæ—¨åœ¨å¾æ‚¨çš„è³‡æ–™åº«ä¸­è­˜åˆ¥ã€åˆ†æä¸¦ç¯„æœ¬åŒ–å”¯ä¸€è­˜åˆ¥ç¢¼ï¼ˆå¦‚è¨‚å–®è™Ÿã€ç”¢å“ç·¨è™Ÿç­‰ï¼‰ã€‚

### åˆ†ææµç¨‹

```mermaid
graph TD
    A[é–‹å§‹åˆ†æ] --> B{éšæ®µä¸€ï¼šå€™é¸æ¬„ä½è­˜åˆ¥};
    B --> C{éšæ®µäºŒï¼šè³‡æ–™ç‰¹å¾µæå–};
    C --> D{éšæ®µä¸‰ & å››ï¼šæ¨¡å¼è­˜åˆ¥èˆ‡æ¨¡æ¿ç”Ÿæˆ};
    D --> E{éšæ®µäº”ï¼šç”Ÿæˆç¸½çµå ±å‘Š}
    E --> F[ç”¢å‡ºç¶œåˆåˆ†æå ±å‘Š];

    subgraph B [LLM é©…å‹•]
        B1[1. æº–å‚™ä¸Šä¸‹æ–‡]
        B2[2. å‘¼å« 'serial_number_candidate_generation' æç¤ºè©]
        B3[3. LLM å›å‚³ JSON æ ¼å¼çš„å€™é¸æ¬„ä½åˆ—è¡¨]
    end

    subgraph C [Python è…³æœ¬]
        C1[1. é‡å°æ¯å€‹å€™é¸æ¬„ä½]
        C2[2. å¾ QA ç¯„ä¾‹çš„ WHERE æ¢ä»¶ä¸­æå–æ¨£æœ¬å€¼]
        C3[3. è¨ˆç®—è³‡æ–™ç‰¹å¾µ(é•·åº¦ã€å”¯ä¸€æ€§ã€å­—å…ƒé¡å‹ç­‰)]
    end
    
    subgraph D [LLM é©…å‹•]
        D1[1. æº–å‚™åŒ…å«ç‰¹å¾µçš„å€™é¸æ¬„ä½ JSON]
        D2[2. å‘¼å« 'pattern_and_template_generation' æç¤ºè©]
        D3[3. LLM å›å‚³åŒ…å«æ¨¡å¼ã€æ­£å‰‡è¡¨é”å¼å’Œå»ºè­°çš„å®Œæ•´å ±å‘Š]
    end

    subgraph E [LLM é©…å‹•]
        E1[1. æº–å‚™éšæ®µå››çš„ JSON å ±å‘Š]
        E2[2. å‘¼å« 'serial_number_summary_generation' æç¤ºè©]
        E3[3. LLM å›å‚³äººé¡å¯è®€çš„ Markdown ç¸½çµ]
    end

    style A fill:#e1f5fe,stroke:#333,stroke-width:2px
    style F fill:#e8f5e9,stroke:#333,stroke-width:2px
```
æœ€çµ‚ï¼Œç³»çµ±æœƒè¼¸å‡ºä¸€ä»½**äººé¡å¯è®€çš„ç¸½çµå ±å‘Š**ï¼Œä¸¦åœ¨ä¸€å€‹å¯æ‘ºç–Šå€åŸŸå…§é™„ä¸Šå®Œæ•´çš„ **JSON æŠ€è¡“ç´°ç¯€**ï¼Œå…¼é¡§äº†æ˜“ç”¨æ€§èˆ‡æ·±åº¦åˆ†æçš„éœ€æ±‚ã€‚

---

## ğŸ”§ æŠ€è¡“æ£§ (Tech Stack)

- **å¾Œç«¯**: Flask, Vanna.ai, SQLAlchemy
- **å‰ç«¯**: Vanilla JavaScript, HTML5, CSS3
- **è³‡æ–™åº«**: SQLite
- **AI æ¨¡å‹**: ç›¸å®¹ Ollama, OpenAI GPT ç­‰
- **è³‡æ–™è™•ç†**: Pandas
- **è¦–è¦ºåŒ–**: Plotly.js

## ğŸ“ å°ˆæ¡ˆçµæ§‹ (Project Structure)

```
dbwiki/
â”œâ”€â”€ app/                  # ä¸»æ‡‰ç”¨ç¨‹å¼ç›®éŒ„
â”‚   â”œâ”€â”€ blueprints/       # Flask è—åœ–æ¨¡çµ„ (API ç«¯é»)
â”‚   â”œâ”€â”€ core/             # æ ¸å¿ƒæ¥­å‹™é‚è¼¯
â”‚   â”œâ”€â”€ utils/            # å·¥å…·å‡½å¼å’Œè£é£¾å™¨
â”‚   â”œâ”€â”€ __init__.py       # æ‡‰ç”¨ç¨‹å¼åˆå§‹åŒ–
â”‚   â””â”€â”€ vanna_wrapper.py  # Vanna AI æ ¸å¿ƒå°è£
â”œâ”€â”€ templates/            # HTML ç¯„æœ¬
â”œâ”€â”€ static/               # éœæ…‹è³‡æº (JS, CSS)
â”œâ”€â”€ prompts/              # æç¤ºè©ç¯„æœ¬ (JSON æ ¼å¼)
â”œâ”€â”€ tests/                # æ¸¬è©¦æª”æ¡ˆ
â”œâ”€â”€ run.py                # æ‡‰ç”¨ç¨‹å¼å…¥å£
â”œâ”€â”€ requirements.txt      # å°ˆæ¡ˆä¾è³´
â””â”€â”€ .env.example          # ç’°å¢ƒè®Šæ•¸ç¯„ä¾‹æª”æ¡ˆ
```

## ğŸ¤ è²¢ç» (Contributing)

æ­¡è¿æäº¤å•é¡Œï¼ˆIssuesï¼‰å’Œæ‹‰å–è«‹æ±‚ï¼ˆPull Requestsï¼‰ã€‚å¦‚æœæ‚¨æœ‰ä»»ä½•æ”¹é€²å»ºè­°ï¼Œè«‹éš¨æ™‚æå‡ºã€‚

åœ¨æäº¤ç¨‹å¼ç¢¼å‰ï¼Œè«‹ç¢ºä¿åŸ·è¡Œæ¸¬è©¦ï¼š
```bash
python -m pytest tests/
```

## ğŸ“„ æˆæ¬Š (License)

æœ¬å°ˆæ¡ˆæ¡ç”¨ MIT æˆæ¬Šã€‚è©³æƒ…è«‹è¦‹ `LICENSE` æª”æ¡ˆã€‚
